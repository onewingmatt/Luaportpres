<!DOCTYPE html>
<html>
<head>
    <title>President Card Game</title>
    <style>
        * { box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 2rem; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        h1 { color: #333; text-align: center; }
        h2 { color: #555; border-bottom: 2px solid #4CAF50; padding-bottom: 0.5rem; }
        .section { margin: 2rem 0; padding: 1.5rem; border: 1px solid #e0e0e0; border-radius: 4px; }
        label { display: block; margin: 0.75rem 0; color: #555; }
        input[type="text"], select { width: 100%; padding: 0.75rem; margin: 0.5rem 0; border: 1px solid #ddd; border-radius: 4px; font-size: 1rem; }
        input[type="checkbox"] { margin-right: 0.5rem; }
        button { padding: 0.75rem 1.5rem; margin: 0.5rem 0.5rem 0.5rem 0; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 1rem; }
        button:hover { background: #45a049; }
        .info { background: #e8f5e9; border-left: 4px solid #4CAF50; padding: 1rem; margin: 1rem 0; border-radius: 4px; }
        #gameSection { display: none; }
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1rem 0; }
        #hand { margin-top: 1rem; padding: 1rem; background: #f9f9f9; border-radius: 4px; min-height: 100px; }
        .card { display: inline-block; padding: 0.5rem 0.75rem; margin: 0.25rem; background: white; border: 1px solid #ddd; border-radius: 4px; font-weight: bold; cursor: pointer; }
        .card:hover { background: #e8f5e9; border-color: #4CAF50; }
    </style>
</head>
<body>
    <div class="container">
        <h1>♠ President Card Game ♠</h1>

        <div class="section" id="setupSection">
            <h2>Create New Game</h2>
            <label>Your Name:
                <input type="text" id="playerName" placeholder="Enter your name">
            </label>

            <label>Number of CPU Players:
                <select id="numCpus">
                    <option value="1">1 CPU</option>
                    <option value="2" selected>2 CPUs</option>
                    <option value="3">3 CPUs</option>
                </select>
            </label>

            <div style="background: #f5f5f5; padding: 1rem; margin: 1rem 0; border-radius: 4px;">
                <h3 style="margin-top: 0;">Game Options</h3>
                <div class="options-grid">
                    <label style="margin: 0;">
                        <input type="checkbox" id="opt-2s"> 2s are Wild
                    </label>
                    <label style="margin: 0;">
                        <input type="checkbox" id="opt-black3"> Black 3s are Wild
                    </label>
                    <label style="margin: 0;">
                        <input type="checkbox" id="opt-jd"> Jack of Diamonds is Wild
                    </label>
                </div>
            </div>

            <button id="createBtn">Create Game</button>
        </div>

        <div class="section" id="gameSection" style="display: none;">
            <h2>Game</h2>
            <div id="gameId" class="info"></div>
            <div id="gameOptions" class="info" style="display:none;"></div>

            <button id="startBtn">Start Game (Deal Cards)</button>
            <button id="leaveBtn">Leave Game</button>

            <div id="dealingSection" style="display:none; margin-top: 1rem;">
                <h3>Dealing cards...</h3>
                <div id="dealStatus"></div>
            </div>

            <div id="playingSection" style="display:none; margin-top: 1rem;">
                <h3>Your Hand</h3>
                <div id="hand"></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script>
        const socket = io();

        document.getElementById('createBtn').onclick = function() {
            const name = document.getElementById('playerName').value.trim();
            if (!name) {
                alert('Please enter your name');
                return;
            }

            const options = {
                wild_2s: document.getElementById('opt-2s').checked,
                wild_black3: document.getElementById('opt-black3').checked,
                wild_jd: document.getElementById('opt-jd').checked
            };

            socket.emit('create', {
                name: name,
                cpus: parseInt(document.getElementById('numCpus').value),
                options: options
            });
        };

        socket.on('game_created', function(data) {
            document.getElementById('setupSection').style.display = 'none';
            document.getElementById('gameSection').style.display = 'block';
            document.getElementById('gameId').textContent = '✓ Game Created: ' + data.game_id;

            const opts = data.options || {};
            let optStr = 'Active Options: ';
            if (opts.wild_2s) optStr += '2s Wild, ';
            if (opts.wild_black3) optStr += 'Black 3s Wild, ';
            if (opts.wild_jd) optStr += 'JD Wild, ';
            if (optStr === 'Active Options: ') optStr += 'None';

            const optsDiv = document.getElementById('gameOptions');
            optsDiv.textContent = optStr;
            optsDiv.style.display = 'block';
        });

        document.getElementById('startBtn').onclick = function() {
            socket.emit('start_game');
        };

        socket.on('ready_to_deal', function(data) {
            document.getElementById('dealingSection').style.display = 'block';
            document.getElementById('dealStatus').textContent = 'Shuffling deck...';
            setTimeout(() => {
                socket.emit('deal_cards');
            }, 500);
        });

        socket.on('cards_dealt', function(data) {
            document.getElementById('dealingSection').style.display = 'none';
            document.getElementById('playingSection').style.display = 'block';

            const handDiv = document.getElementById('hand');
            handDiv.innerHTML = '';
            data.hand.forEach(card => {
                const cardEl = document.createElement('div');
                cardEl.className = 'card';
                cardEl.textContent = card.rank + card.suit;
                handDiv.appendChild(cardEl);
            });

            document.getElementById('dealStatus').textContent = `Dealt ${data.hand_size} cards to you and ${data.player_count - 1} other players`;
        });

        document.getElementById('leaveBtn').onclick = function() {
            if (confirm('Leave game?')) {
                location.reload();
            }
        };

        socket.on('game_started', function(data) {
            console.log('Game started:', data);
        });

        socket.on('error', function(data) {
            alert('Error: ' + data.message);
        });
    </script>
</body>
</html>
